---
layout: post
comments: true
categories: 机器学习
---
&emsp;&emsp;总结几个常用的文本分类器，从数学原理到效果测评。

#### 一、常用文本分类器
##### 1、朴素贝叶斯分类器

<img src="http://chart.googleapis.com/chart?cht=tx&chl=P(Y|X)=\frac{P(Y)P(X|Y)}{P(X)}">

P(Y|X)是已知X发生后Y的条件概率，也由于得自X的取值而被称作Y的后验概率。    
P(Y)是Y的先验概率（或边缘概率）。之所以称为"先验"是因为它不考虑任何X方面的因素。

在文本分类中，Y代表文本所属类别，X代表出现的文本。分类器解决的问题是，寻找最大的P(Y|X)，即Y在给定X下的最大后验概率。

注意公式中的分母部分，在给定X条件下，与Y无关，所以只需要比较分子部分P(Y)P(X|Y)即可。其中P(X|Y)称为似然项。假设短文本长度为N（X的维度）,词表大小为M（X每一维的取值），类别数为K(Y的取值)。整体的组合复杂度为<img src="http://chart.googleapis.com/chart?cht=tx&chl=K*M^{N}">，复杂度过高，所以引入条件独立性假设，各个词之间独立出现，不会相互影响。这样似然项可以改写为P((X1,X2,...Xm)|Y) ,如果不考虑位置，复杂度降为K*M。在实际使用中，还要考虑由于数据不足导致的某个词在某个类别下没有出现的情况，加入拉普拉斯平滑项。

举一个实际的例子，出自信息检索导论
类别：短文本
Chine: Chinese Beijing Chinese

|类别|短文本|
|:---:|:---:|
|Chine| Chinese Beijing Chinese |
|Chine| Chinese Chinese Shanghai|
|Chine| Chinese Macao|
|Japan| Tokyo Japanese Chinese|
|?| Chinese Chinese Chinese Tokyo Japanese|

根据前四条训练数据，判断最后一条数据所属类别。首先求各个类别的先验概率：

P(Chine)=3/4
p(Japan)1/4
然后统计加入拉普拉斯平滑后的各个词在各个类别下的后验概率：

P(Chinese|Chine) = (5+1)/(8+6) = 3/7    
p(Beijing|Chine) = (1+1)/(8+6) = 1/7    
P(Shanghai|Chine) = (1+1)/(8+6) = 1/7    
p(Macao|Chine) = (1+1)/(8+6) = 1/7    
p(Japanese|Chine) = (0+1)/(8+6) = 1/14    
p(Tokyo|Chine) = (0+1)/(8+6) = 1/14   

P(Chinese|Japan) = (1+1)/(3+6) = 2/9    
p(Beijing|Japan) = (0+1)/(3+6) = 1/9    
P(Shanghai|Japan) = (0+1)/(3+6) = 1/9    
p(Macao|Japan) = (0+1)/(3+6) = 1/9    
p(Japanese|Japan) = (1+1)/(3+6) = 2/9    
p(Tokyo|Japan) = (1+1)/(3+6) = 2/9    

测试数据在各个类别下概率计算：
<img src="http://chart.googleapis.com/chart?cht=tx&chl=P(China|Chinese Chinese Chinese Tokyo Japanese)=>
P(China)P(Chinese|China)^{3}P(Tokyo|China)P(Japanese|China)=\frac{3}{4}\ast (\frac{3}{7})^{3}\ast \frac{1}{14}\ast \frac{1}{14}
">
<img src="http://chart.googleapis.com/chart?cht=tx&chl=P(Japan|Chinese Chinese Chinese Tokyo Japanese)=>
P(Japan)P(Chinese|Japan)^{3}P(Tokyo|Japan)P(Japanese|Japan)=\frac{1}{4}\ast (\frac{2}{9})^{3}\ast \frac{2}{9}\ast \frac{2}{9}
">
测试数据在Chine类下的概率为0.0003，在Japan类的概率为0.0001，所以会分到Chine类下。

#### fastText介绍
fastText是facebook提出的一个文本分类器，其特点是实现简单，训练速度快。在普通cpu上，fastText可以在10分钟内训练10亿条数据，在1分钟内预测50万条数据分类。（类别种类30万）

fastText的网络结构和word2vec的CBOW十分相似，只是把中间词换成了类别标签。其网络结构如下：
![](http://ww1.sinaimg.cn/large/75e7ad61ly1fv0125naagj20go08aaa9.jpg)
